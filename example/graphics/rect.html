<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <div id="app">
    <div id="game-container">
      <canvas id="game-canvas" width="1200" height="800" style="border:1px solid #000;"></canvas>
    </div>
  </div>

  <script type="module">
    import { Engine, Components } from '../../src/main.ts';
    const canvas = document.getElementById("game-canvas");
    export const engine = new Engine(canvas);
    // 显示包围盒调试信息
    engine.boxDebug = true;
    
    // 创建多个静态矩形
    
    // 矩形1: 蓝色矩形
    const rectEntity1 = engine.ecs.createEntity();
    const rect1 = new Components.Rect(engine, {
      width: 200,
      height: 150,
      fillStyle: "#3498db",
      strokeStyle: "#2c3e50",
      lineWidth: 3
    });
    const transform1 = new Components.Transform(engine, { 
      x: 100, 
      y: 100 
    });
    engine.ecs.addComponent(rectEntity1, rect1);
    engine.ecs.addComponent(rectEntity1, transform1);
    engine.add(rectEntity1);
    
    // 矩形2: 红色矩形
    const rectEntity2 = engine.ecs.createEntity();
    const rect2 = new Components.Rect(engine, {
      width: 150,
      height: 200,
      fillStyle: "#e74c3c",
      strokeStyle: "#c0392b",
      lineWidth: 2
    });
    const transform2 = new Components.Transform(engine, { 
      x: 400, 
      y: 100 
    });
    engine.ecs.addComponent(rectEntity2, rect2);
    engine.ecs.addComponent(rectEntity2, transform2);
    engine.add(rectEntity2);
    
    // 矩形3: 绿色矩形
    const rectEntity3 = engine.ecs.createEntity();
    const rect3 = new Components.Rect(engine, {
      width: 250,
      height: 100,
      fillStyle: "#2ecc71",
      strokeStyle: "#27ae60",
      lineWidth: 4
    });
    const transform3 = new Components.Transform(engine, { 
      x: 100, 
      y: 300 
    });
    engine.ecs.addComponent(rectEntity3, rect3);
    engine.ecs.addComponent(rectEntity3, transform3);
    engine.add(rectEntity3);
    
    // 矩形4: 黄色矩形
    const rectEntity4 = engine.ecs.createEntity();
    const rect4 = new Components.Rect(engine, {
      width: 180,
      height: 180,
      fillStyle: "#f1c40f",
      strokeStyle: "#f39c12",
      lineWidth: 1
    });
    const transform4 = new Components.Transform(engine, { 
      x: 450, 
      y: 350 
    });
    engine.ecs.addComponent(rectEntity4, rect4);
    engine.ecs.addComponent(rectEntity4, transform4);
    engine.add(rectEntity4);
    
    // 矩形5: 紫色矩形
    const rectEntity5 = engine.ecs.createEntity();
    const rect5 = new Components.Rect(engine, {
      width: 120,
      height: 240,
      fillStyle: "#9b59b6",
      strokeStyle: "#8ec400",
      lineWidth: 12,
      radius: 20, // 设置圆角半径
    });
    const transform5 = new Components.Transform(engine, { 
      x: 750, 
      y: 150,
      rotation: Math.PI / 6
    });
    engine.ecs.addComponent(rectEntity5, rect5);
    engine.ecs.addComponent(rectEntity5, transform5);
    engine.add(rectEntity5);
    
    // 矩形6: 动态变化的矩形（保留原有动态效果）
    const rectEntity6 = engine.ecs.createEntity();
    const rect6 = new Components.Rect(engine, {
      width: 200,
      height: 200,
      fillStyle: "#e67e22",
      strokeStyle: "#d33212",
      lineWidth: 1,
    });
    const transform6 = new Components.Transform(engine, { 
      x: 0, 
      y: 0,
      scaleX:1,
      scaleY: 1,
      pivotX: 100,
      pivotY: 100,
      // rotation: Math.PI / 4
    });
    const event6 = new Components.EventComponent(engine);
    engine.ecs.addComponent(rectEntity6, rect6);
    engine.ecs.addComponent(rectEntity6, transform6);
    engine.ecs.addComponent(rectEntity6, event6);
    engine.add(rectEntity6);
    
    // 动态修改矩形属性
    let isExpanding = true;
    engine.ticker.add(() => {
      // transform6.di
      transform6.dirty = false;
      if (isExpanding) {
        rect6.width += 0.5;
        rect6.height += 0.3;
        if (rect6.width > 300) {
          isExpanding = false;
        }
      } else {
        rect6.width -= 0.5;
        rect6.height -= 0.3;
        if (rect6.width < 200) {
          isExpanding = true;
        }
      }
    });
    
    // 添加点击事件
    event6.on('click', (e) => { 
      console.log('动态矩形被点击', e); 
    });
    
    // 启动引擎
    engine.start();
  </script>
</body>

</html>