<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>树形结构（上到下） + 游离节点</title>
</head>

<body>
  <div id="app">
    <h2>测试点击事件</h2>
    <div id="game-container">
      <canvas id="game-canvas" width="1200" height="1200" style="border: 1px solid #000;"></canvas>
    </div>
  </div>

  <script type="module">
    import { engine, CircleApi, RectApi, bindEvent } from './utils.js';

    // =====================
    // 根节点（绝对坐标）
    // =====================
    const root = RectApi(
      { x: 600, y: 50 }, // 根节点居中上方
      { width: 120, height: 60, fillStyle: '#3498db' },
    );

    // =====================
    // 第一层子节点（相对于 root）
    // =====================
    const c1 = CircleApi(
      { x: -250, y: 150 }, // 左子节点
      { radius: 40, fillStyle: '#e74c3c' },
      { rotation: .5 }
    );
    const c1Event = bindEvent(c1);
    c1Event.on('click', (e, entity) => {
      console.log("点击了c1", e, entity);
      return true
    })

    const c5 = RectApi(
      { x: 0, y: 150 }, // 中间子节点
      { width: 80, height: 50, fillStyle: '#1abc9c' },
      { rotation: .5 }
    );

    const c2 = CircleApi(
      { x: 250, y: 150 }, // 右子节点
      { radius: 35, fillStyle: '#f39c12' },
    );
    const c2Event = bindEvent(c2);
    c2Event.on('wheel', (e, entity) => {
      console.log("wheel c2", e, entity);
      return true
    })

    // =====================
    // 第二层子节点（相对于父节点）
    // =====================
    const c3 = RectApi(
      { x: 0, y: 150 }, // c1 的子节点
      { width: 60, height: 40, fillStyle: '#9b59b6' }
    );

    const c6 = CircleApi(
      { x: 0, y: 150 }, // c5 的子节点
      { radius: 20, fillStyle: '#e67e22' }
    );

    const c4 = CircleApi(
      { x: -100, y: 150 }, // c2 的左子节点
      { radius: 25, fillStyle: '#2ecc71' }
    );

    const c7 = RectApi(
      { x: 100, y: 150 }, // c2 的右子节点
      { width: 50, height: 50, fillStyle: '#34495e' },
    );

    // =====================
    // 游离节点
    // =====================
    const c8 = CircleApi(
      { x: 1050, y: 600 }, // 右下角独立节点
      { radius: 30, fillStyle: '#ff00ff', strokeStyle: '#000', lineWidth: 2 }
    );

    // =====================
    // 构建树形关系
    // =====================
    engine.add(root);
    const rootEvent = bindEvent(root);
    rootEvent.on('click', (e) => {
      console.log("点击了根节点", e);
    })
    // 第一层
    engine.add(c1, root);
    engine.add(c5, root);
    engine.add(c2, root);

    // 第二层
    engine.add(c3, c1);
    engine.add(c6, c5);
    engine.add(c4, c2);
    engine.add(c7, c2);

    // 游离节点
    engine.add(c8);

    // =====================
    // 启动引擎
    // =====================
    engine.start();

    // =====================
    // 打印每个节点的绝对位置（用于验证布局）
    // =====================
    const nodes = [
      { name: "root", entity: root },
      { name: "c1", entity: c1 },
      { name: "c5", entity: c5 },
      { name: "c2", entity: c2 },
      { name: "c3", entity: c3 },
      { name: "c6", entity: c6 },
      { name: "c4", entity: c4 },
      { name: "c7", entity: c7 },
      { name: "c8", entity: c8 }
    ];


  </script>
</body>

</html>
